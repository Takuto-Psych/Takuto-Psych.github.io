<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <script type="application/javascript" src='https://takuto-psych.github.io/js/theme-mode.js'></script>
    <link rel="stylesheet" href='https://takuto-psych.github.io/css/frameworks.min.css' />
    <link rel="stylesheet" href='https://takuto-psych.github.io/css/github.min.css' />
    <link rel="stylesheet" href='https://takuto-psych.github.io/css/github-style.css' />
    <link rel="stylesheet" href='https://takuto-psych.github.io/css/light.css' />
    <link rel="stylesheet" href='https://takuto-psych.github.io/css/dark.css' />
    <link rel="stylesheet" href='https://takuto-psych.github.io/css/syntax.css' />
    <title>NPS?何それ美味しいの？美味しかったよ - Takuto Psych Blog</title>
    
    <link rel="icon" type="image/x-icon" href='/images/avatar.png'>
    
    <meta name="theme-color" content="#1e2327">

    
    <meta name="description"
  content="ヒストグラム描けや" />
<meta name="keywords"
  content=', ' />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://takuto-psych.github.io/post/2022-08-10-/" />


<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="NPS?何それ美味しいの？美味しかったよ - Takuto Psych Blog" />
<meta name="twitter:description"
  content="ヒストグラム描けや" />
<meta name="twitter:site" content="https://takuto-psych.github.io/" />
<meta name="twitter:creator" content="R package build" />
<meta name="twitter:image"
  content="https://takuto-psych.github.io/">


<meta property="og:type" content="article" />
<meta property="og:title" content="NPS?何それ美味しいの？美味しかったよ - Takuto Psych Blog">
<meta property="og:description"
  content="ヒストグラム描けや" />
<meta property="og:url" content="https://takuto-psych.github.io/post/2022-08-10-/" />
<meta property="og:site_name" content="NPS?何それ美味しいの？美味しかったよ" />
<meta property="og:image"
  content="https://takuto-psych.github.io/">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2022-08-10 00:00:00 &#43;0000 UTC" />









<script async src="https://www.googletagmanager.com/gtag/js?id=G-0E1T9Y2XZS"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-0E1T9Y2XZS');
</script>

    
    <meta name="google-site-verification" content="ZTJLaWcJsPiyOc11H0OSIjk1bYevn3VcRp4FNnJVpuw" />
</head>

<body>
  <div style="position: relative">
  <header class="Header js-details-container Details px-3 px-md-4 px-lg-5 flex-wrap flex-md-nowrap open Details--on">
    <div class="Header-item mobile-none" style="margin-top: -4px; margin-bottom: -4px;">
      <a class="Header-link " href="https://takuto-psych.github.io/">
        <span style="margin-left: 8px;">
          Takuto Psych Blog
        </span>
      </a>
    </div>
    
    <div class="Header-item Header-item--full flex-justify-center d-md-none position-relative">
      <a class="Header-link " href="https://takuto-psych.github.io/">
        
        <span style="margin-left: 8px;">
          Takuto Psych Blog
        </span>
      </a>
    </div>
    <div class="Header-item" style="margin-left: auto;">
      <a href="javascript:void(0)" class="Header-link no-select" onclick="switchTheme()">
        <svg style="fill: var(--color-profile-color-modes-toggle-moon);" class="no-select" viewBox="0 0 16 16"
          version="1.1" width="16" height="16">
          <path fill-rule="evenodd" clip-rule="evenodd"
            d="M4.52208 7.71754C7.5782 7.71754 10.0557 5.24006 10.0557 2.18394C10.0557 1.93498 10.0392 1.68986 10.0074 1.44961C9.95801 1.07727 10.3495 0.771159 10.6474 0.99992C12.1153 2.12716 13.0615 3.89999 13.0615 5.89383C13.0615 9.29958 10.3006 12.0605 6.89485 12.0605C3.95334 12.0605 1.49286 10.001 0.876728 7.24527C0.794841 6.87902 1.23668 6.65289 1.55321 6.85451C2.41106 7.40095 3.4296 7.71754 4.52208 7.71754Z">
          </path>
        </svg>
      </a>
    </div>
  </header>
</div>
  
<div>
  <main>
    <div class="gisthead pagehead bg-gray-light pb-0 pt-3 mb-4">
      <div class="px-0">
        <div class="mb-3 d-flex px-3 px-md-3 px-lg-5">
          <div class="flex-auto min-width-0 width-fit mr-3">
            <div class="d-flex">
              <div class="d-none d-md-block">
                <a class="avatar mr-2 flex-shrink-0" href="https://takuto-psych.github.io/">
                  <img class=" avatar-user"
                    src="https://takuto-psych.github.io/images/avatar.png"
                    width="32" height="32"></a>
              </div>
              <div class="d-flex flex-column">
                <h1 class="break-word f3 text-normal mb-md-0 mb-1">
                  <span class="author">
                    <a href="https://takuto-psych.github.io/">Takuto-Psych</a></span><span
                    class="path-divider">/</span><strong class="css-truncate-target mr-1" style="max-width: 410px"><a
                      href="https://takuto-psych.github.io/post/2022-08-10-/">NPS?何それ美味しいの？美味しかったよ</a></strong>
                </h1>
                <div class="note m-0">
                  Created <relative-time datetime="Wed, 10 Aug 2022 00:00:00 &#43;0000"
                    class="no-wrap">
                    Wed, 10 Aug 2022 00:00:00 &#43;0000</relative-time>

                  
                  <span class="file-info-divider"></span>
                  Modified <relative-time datetime="Mon, 22 Aug 2022 01:26:07 &#43;0900"
                    class="no-wrap">
                    Mon, 22 Aug 2022 01:26:07 &#43;0900</relative-time>
                  
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container-lg px-3 new-discussion-timeline">
      <div class="repository-content gist-content">
        <div>
          <div class="js-gist-file-update-container js-task-list-container file-box">
            <div id="file-pytest" class="file my-2">
              <div id="post-header" class="file-header d-flex flex-md-items-center flex-items-start sticky-header" style="z-index: 2">
                <div class="file-info d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto">
                  <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">
                    
                    <summary id="toc-toggle" onclick="clickToc()" class="btn btn-octicon m-0 mr-2 p-2">
                      <svg aria-hidden="true" viewBox="0 0 16 16" height="16" width="16" class="octicon octicon-list-unordered">
                        <path fill-rule="evenodd" d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zM3 8a1 1 0 11-2 0 1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z"></path>
                      </svg>
                    </summary>
                    <details-menu class="SelectMenu" id="toc-details" style="display: none;">
                      <div class="SelectMenu-modal rounded-3 mt-1" style="max-height: 340px;">
                        <div class="SelectMenu-list SelectMenu-list--borderless p-2" style="overscroll-behavior: contain;" id="toc-list">
                        </div>
                      </div>
                    </details-menu>
                      3123 Words
                    

                  </div>
                  <div class="file-actions flex-order-2 pt-0">
                    
                    
                    <a class="muted-link mr-3" href="/tags/%E3%83%87%E3%83%BC%E3%82%BF%E3%82%B5%E3%82%A4%E3%82%A8%E3%83%B3%E3%82%B9">
                      <svg class="octicon octicon-tag" viewBox="0 0 16 16" version="1.1" width="16" height="16">
                        <path fill-rule="evenodd"
                          d="M2.5 7.775V2.75a.25.25 0 01.25-.25h5.025a.25.25 0 01.177.073l6.25 6.25a.25.25 0 010 .354l-5.025 5.025a.25.25 0 01-.354 0l-6.25-6.25a.25.25 0 01-.073-.177zm-1.5 0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 010 2.474l-5.026 5.026a1.75 1.75 0 01-2.474 0l-6.25-6.25A1.75 1.75 0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z">
                        </path>
                      </svg>
                      データサイエンス
                    </a>
                    
                    <a class="muted-link mr-3" href="/tags/%E7%B5%B1%E8%A8%88%E5%AD%A6">
                      <svg class="octicon octicon-tag" viewBox="0 0 16 16" version="1.1" width="16" height="16">
                        <path fill-rule="evenodd"
                          d="M2.5 7.775V2.75a.25.25 0 01.25-.25h5.025a.25.25 0 01.177.073l6.25 6.25a.25.25 0 010 .354l-5.025 5.025a.25.25 0 01-.354 0l-6.25-6.25a.25.25 0 01-.073-.177zm-1.5 0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 010 2.474l-5.026 5.026a1.75 1.75 0 01-2.474 0l-6.25-6.25A1.75 1.75 0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z">
                        </path>
                      </svg>
                      統計学
                    </a>
                    
                    <a class="muted-link mr-3" href="/tags/%E3%83%9E%E3%83%BC%E3%82%B1%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0%E3%83%AA%E3%82%B5%E3%83%BC%E3%83%81">
                      <svg class="octicon octicon-tag" viewBox="0 0 16 16" version="1.1" width="16" height="16">
                        <path fill-rule="evenodd"
                          d="M2.5 7.775V2.75a.25.25 0 01.25-.25h5.025a.25.25 0 01.177.073l6.25 6.25a.25.25 0 010 .354l-5.025 5.025a.25.25 0 01-.354 0l-6.25-6.25a.25.25 0 01-.073-.177zm-1.5 0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 010 2.474l-5.026 5.026a1.75 1.75 0 01-2.474 0l-6.25-6.25A1.75 1.75 0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z">
                        </path>
                      </svg>
                      マーケティングリサーチ
                    </a>
                    
                    
                  </div>
                </div>
              </div>
              <div class="Box-body px-5 pb-5" style="z-index: 1">
                <article class="markdown-body entry-content container-lg">


<p>新卒で入った会社でマーケティングリサーチの部署にいて、日々ログデータなどなどの数値をSQL描いて抽出して、お絵描きしています。元気です。最近は、アンケートのデータもいじったりしています。そんな業務の中で名前を知って、何やお前ってなった概念NPSについての数理的（面積を求める程度）な理解をしたので、備忘録がてら説明しようかなと思いました。そんなわけで書いていきます。</p>
<div id="npsとは" class="section level2">
<h2>NPSとは</h2>
<p>NPSとは、「Net Promoter Score（ネットプロモータスコア）」の略称です。この指標を用いると、顧客ロイヤリティが測れる指標だそうです。すごいですね。</p>
<p>この指標は、なんか知らんけど顧客と企業との間の愛着や信頼が表現できて凄いらしいです。あと、企業の業績上昇と関連があるそうです。凄いですね。この指標のすごいところの説明についての詳細は、<a href="https://www.nttcoms.com/service/nps/summary/">NTTコムオンラインの資料</a>を参照してください。なんか凄いそうです。</p>
</div>
<div id="npsの計測方法" class="section level2">
<h2>NPSの計測方法</h2>
<p>このNPSを計測するには、顧客に対して「あなたはこの企業(製品/サービス/ブランド)を友人や同僚に薦める可能性は、どのくらいありますか？」と質問して、『0（全くそう思わない）~　5(どちらでもない) ~ 10(非常にそう思う)』の11段階で回答してもらうのだそうです。簡単ですね。</p>
<p>NPSでは、以上の質問の回答について、0点~6点の回答者に「批判者」、7 ~ 8点の回答者に「中立者」9 ~ 10 点の回答者に「推奨者」というラベルを貼ります。そして、全ての回答者に占める推奨者の割合から批判者の割合を引いたものをNPSスコアと呼ぶのだそうです。</p>
<p>補足として、上の計算方法で書いた<strong>割合</strong>はパーセンテージで表現した0~100の値を利用します。だから、全員推奨者の場合の <code>100 % - 0 % = 100 %</code> の100から、全批判者の場合の <code>0% - 100 % = - 100 %</code> の-100というスコアの間を取るのだそうです。ビジネスの場ではパーセントが好かれているんですね。</p>
<p>ただし、今回の記事では、パーセントで表現すると若干めんどくさいので、その<strong>割合</strong>を0以上1以下の少数で表すことにします。なので、本記事でのNPSは -1 ~ 1 の値を取ります。ビジネスライクな表現で理解したい人は、100掛けといてください。</p>
<p>さて、上に書いた計測方法を見たときの最初に抱いた僕の感想を箇条書きにしておきます。</p>
<ul>
<li><p>11件法。。。無理矢理分散作ろうとしてる心理学の卒論みたいやな</p></li>
<li><p>平均値と中央値と分散の代表値でよくないか</p></li>
<li><p>ん？このNPSって、代表値みたいなもんと捉えて良いんか</p></li>
</ul>
<p>多分みんな似たような感覚を持つでしょう。特に生データじっくり見る系の人は。んで、多分この指標の価値や意味が全くわからなくなるでしょうね。実際僕も業務でNPS実際に出すまでこの指標の価値がわかりませんでした。</p>
</div>
<div id="仮想アンケートデータでnpsというものの振る舞いをチェック" class="section level2">
<h2>仮想アンケートデータでNPSというものの振る舞いをチェック</h2>
<pre class="r"><code>##おまじない
rm(list = ls())
library(tidyverse)
library(DT)
library(SimMultiCorrData)
## macユーザーの皆様に向けて
set.seed(2525)</code></pre>
<p>ここからは乱数生成で模擬的なアンケート回答データを作成して、そのデータを見ながらNPSという指標の意味について解説していきます。</p>
<p>ここからは、乱数さん11000人をお呼びして彼らが回答してくれたアンケートデータを作ります。今回のアンケートデータでは、生データとして、<code>company_id</code> 、<code>answer</code> 、の列を用意します。それぞれ、アンケートの実施会についてのid、実際に得られたアンケート結果とします。</p>
<p>これから作るデータについて表にしてまとめておきます。</p>
<table>
<colgroup>
<col width="19%" />
<col width="19%" />
<col width="61%" />
</colgroup>
<thead>
<tr class="header">
<th>company_id</th>
<th>分布</th>
<th>与えるパラメータ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A社</td>
<td>一様分布</td>
<td>ビヨーン。平均5</td>
</tr>
<tr class="even">
<td>B社</td>
<td>正規分布</td>
<td>平均値5、SD1</td>
</tr>
<tr class="odd">
<td>C社</td>
<td>高得点者が多い分布</td>
<td>平均5、SD1、歪度-0.8（分布を右寄りに）</td>
</tr>
<tr class="even">
<td>D社</td>
<td>低得点者が多い分布</td>
<td>平均5、SD1、歪度 .08（分布を左寄りに）</td>
</tr>
<tr class="odd">
<td>E社</td>
<td>二山分布（双峰分布）</td>
<td>平均5、SD1、歪度-0.8の乱数さん5500人と平均5、SD1、歪度0.8の乱数さん5500人をくっつけ</td>
</tr>
</tbody>
</table>
<div id="シミュレーション時のパラメータ付与" class="section level4">
<h4>シミュレーション時のパラメータ付与</h4>
<pre class="r"><code>sample_size &lt;- 11000
mean &lt;- 5
sd &lt;- 1.5
skew &lt;- 0.8</code></pre>
</div>
<div id="乱数さんご回答ありがとうございます" class="section level3">
<h3>乱数さんご回答ありがとうございます</h3>
<pre class="r"><code>DF_a &lt;- data.frame(
  company_id = &quot;A&quot;,
  answer = floor( ## 0から11の一様乱数生成して、最後に小数点以下を切り捨て。
    runif(sample_size, min=0, max=10+1)
  )
)

DF_b &lt;- data.frame(
  company_id = &quot;B&quot;,
  answer = floor( ## 0から11の正規乱数生成して最後に小数点以下を切り捨て。
    truncnorm::rtruncnorm(n = sample_size, a = 0, b = 10+1, mean = mean + 0.5, sd = sd)　## 小数点以下の切り捨ての関係で、0〜11の範囲で乱数作ってるので、その中心の5.5をmeanに設定。
  )
)


c &lt;- nonnormvar1( ##歪度0.5尖度0平均5.5の乱数生成。リストが出来上がる。
    method = &quot;Fleishman&quot;,
    skews = - skew,
    skurts = 0,
    n = sample_size,
    mean = mean + 0.5,
    vars = sd^2
  )


DF_c &lt;- data.frame(
  company_id = &quot;C&quot;,
  answer = floor(
    c[[&quot;continuous_variable&quot;]]$V1
  )
)




d &lt;- nonnormvar1( ##歪度0.5尖度0平均5.5の乱数生成。リストが出来上がる。
    method = &quot;Fleishman&quot;,
    skews = skew,
    skurts = 0,
    n = sample_size,
    mean = mean + 0.5,
    vars = sd^2
  )


DF_d &lt;- data.frame(
  company_id = &quot;D&quot;,
  answer = floor(
    d[[&quot;continuous_variable&quot;]]$V1
  )
)


f &lt;- nonnormvar1( ##歪度0.5尖度0平均5.5の乱数生成。リストが出来上がる。
    method = &quot;Fleishman&quot;,
    skews = skew,
    skurts = 0,
    n = sample_size / 2,
    mean = mean - 3.5,
    vars = sd^2
  )

f &lt;- f[[&quot;continuous_variable&quot;]]$V1


g &lt;- nonnormvar1( ##歪度0.5尖度0平均5.5の乱数生成。リストが出来上がる。
    method = &quot;Fleishman&quot;,
    skews = - skew,
    skurts = 0,
    n = sample_size / 2,
    mean = mean + 3.5,
    vars = sd^2
  )

g &lt;- g[[&quot;continuous_variable&quot;]]$V1

e &lt;- c(f,g)

DF_e &lt;- data.frame(
  company_id = &quot;E&quot;,
  answer = floor(e)
)

DF &lt;- rbind(DF_a, DF_b, DF_c, DF_d, DF_e)
DF &lt;- DF %&gt;% mutate(
  .,
  NPS_label =  case_when(
    answer &gt;= 9 ~ &quot;promoter&quot;,
    answer &lt;= 6 ~ &quot;detractor&quot;,
    answer &lt;= 8 ~ &quot;passive&quot;
  )
)</code></pre>
</div>
</div>
<div id="シミュレーションされたデータを確認" class="section level2">
<h2>シミュレーションされたデータを確認</h2>
<div id="変なデータないかチェック" class="section level3">
<h3>変なデータないかチェック</h3>
<p>シミュレーションされたA社~E社についてそれぞれの記述統計量を確認してみます。</p>
<p>まずは、想定外の値を出していないかの確認。</p>
<pre class="r"><code>tapply(DF$answer, DF$company_id, min) ## 最小値確認</code></pre>
<pre><code>##  A  B  C  D  E 
##  0  0  0  3 -1</code></pre>
<pre class="r"><code>tapply(DF$answer, DF$company_id, max) ## 最大値確認</code></pre>
<pre><code>##  A  B  C  D  E 
## 10 10  7 10 10</code></pre>
<pre class="r"><code>table(DF$company_id)</code></pre>
<pre><code>## 
##     A     B     C     D     E 
## 11000 11000 11000 11000 11000</code></pre>
<p>質問紙の想定してる範囲からはみ出してる回答者はどの会社にもいませんね。あと、その想定してる範囲の回答者が設定した11000人いましたね。よかった。</p>
<p>次は平均値の確認。</p>
<pre class="r"><code>tapply(DF$answer, DF$company_id, mean) ## 平均値算出</code></pre>
<pre><code>##        A        B        C        D        E 
## 4.927455 4.999636 5.021909 4.975455 4.503273</code></pre>
<p>まあ当然と言えば当然ですが、平均値については、想定した5という得点にまとまりました。</p>
<p>次に標準偏差SDについては、</p>
<pre class="r"><code>tapply(DF$answer, DF$company_id, sd) ## SD算出</code></pre>
<pre><code>##        A        B        C        D        E 
## 3.170061 1.514965 1.554353 1.557965 3.850486</code></pre>
<p>乱数生成の際にパラメータとしてSD = sd（分散 = 1.5 ^ 2）を与えたB,C,D社については1.5になってくれました。ただし、パラメータを与えなかった一様分布のA社と二山分布のE社のそれは1.5になっていません。まあ当然のことですね。</p>
<p>まあ変なデータはなさそうですね。よかったよかった。</p>
</div>
<div id="section" class="section level3">
<h3></h3>
</div>
<div id="ヒストグラム確率密度関数の分布を見てみよう" class="section level3">
<h3>ヒストグラム（確率密度関数の分布）を見てみよう</h3>
<p>簡単に出せてありがとう、ggplot2様。</p>
<pre class="r"><code>DF %&gt;% ggplot(
  .,
  aes(x = answer, color = company_id)
) + geom_density(
  adjust = 2
)　+ xlim(-3, 13) </code></pre>
<p><img src="https://takuto-psych.github.io/post/2022-08-10-/index_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>一応補足ですが、本来はデータは0~10敷かないのですが、確率密度の分布を滑らかにしているので、0未満10より大きいx軸も含められちゃってます。ヒストグラムも書いとくので、あんまりお気になさらず。</p>
<pre class="r"><code>DF %&gt;% ggplot(
  .,
  aes(x = answer, fill = company_id)
) + geom_histogram(
  position = &quot;identity&quot;,
  alpha = 0.8
)　+ xlim(-3, 13) </code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 10 rows containing missing values (geom_bar).</code></pre>
<p><img src="https://takuto-psych.github.io/post/2022-08-10-/index_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>さて、最後に、NPSをそれぞれの会社で出してみましょう。</p>
<p>NPSの出し方は、<code>(0~6の回答をした人の人数 - 9と10の回答をした人の人数 ) / その会社のアンケートの回答者数</code> なので、それを計算しましょう</p>
<pre class="r"><code>## その範囲に回答者がいなかった場合、tidyverse::coutでは0が入らないため、チェック用に全会社idを取り出す。

company_ids &lt;- DF %&gt;% distinct(., company_id) %&gt;% unlist()

## 批判者（detoractor）の数を数える。
detractor_num &lt;- DF %&gt;% group_by(
  .,
  company_id
) %&gt;% count(
  .,
  answer &lt;= 6
) %&gt;% filter(
  .,
  `answer &lt;= 6` == TRUE
) %&gt;% mutate(
  .,
  n = n /sample_size
) %&gt;% select(
  .,
  company_id, n
)

add_detractor_num &lt;- data.frame(
  company_id = company_ids[!company_ids %in% detractor_num$company_id],
  n = ifelse(
    is_empty(company_ids[!company_ids %in% detractor_num$company_id]), list(NULL),
    0
  )
)

detractor_num &lt;- rbind(detractor_num ,add_detractor_num)

detractor_num &lt;- detractor_num %&gt;% arrange(
  .,
  company_id
)




## 推奨者（detoractor）の数を数える。
promoter_num &lt;- DF %&gt;% group_by(
  .,
  company_id
) %&gt;% count(
  .,
  answer &gt;= 9
) %&gt;% filter(
  .,
  `answer &gt;= 9` == TRUE
) %&gt;% mutate(
  .,
  n = n /sample_size
) %&gt;% select(
  .,
  company_id, n
)

add_promoter_num &lt;- data.frame(
  company_id = company_ids[!company_ids %in% promoter_num$company_id],
  n = ifelse(
    is_empty(company_ids[!company_ids %in% promoter_num$company_id]), list(NULL),
    0
  )
)

promoter_num &lt;- rbind(promoter_num, add_promoter_num)

promoter_num &lt;- promoter_num %&gt;% arrange(
  .,
  company_id
)


DF_nps &lt;- full_join(promoter_num, detractor_num, by = &quot;company_id&quot;)

colnames(DF_nps) &lt;- c(&quot;company_id&quot;, &quot;promoter_ratio&quot;, &quot;detractor_ratio&quot;)

DF_nps &lt;- DF_nps %&gt;% mutate(
  .,
  nps_score = promoter_ratio - detractor_ratio
)</code></pre>
</div>
</div>
</article>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>

<script type="application/javascript" src='https://takuto-psych.github.io/js/toc.js'></script>
<link rel="stylesheet" href='https://takuto-psych.github.io/css/toc.css' />


<div class="utterances">
  <script>
    if(currentTheme() == 'light'){
      var utterancesTheme = 'github-light';
    } else{
      var utterancesTheme = 'github-dark';
    }
    var utterancesScript = document.createElement('script');
    utterancesScript.src = 'https://utteranc.es/client.js';
    utterancesScript.setAttribute('repo', 'Takuto-Psych\/Takuto-Psych.github.io');
    utterancesScript.setAttribute('issue-term', 'title');
    utterancesScript.setAttribute('theme', utterancesTheme);
    utterancesScript.setAttribute('crossorigin', 'anonymous');
    utterancesScript.setAttribute('async', '');
    document.querySelector('.utterances').appendChild(utterancesScript);
  </script>
</div>


  <div class="footer container-xl width-full p-responsive">
  <div
    class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between flex-sm-items-center pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light ">
    <a aria-label="Homepage" title="GitHub" class="footer-octicon d-none d-lg-block mr-lg-4" href="https://takuto-psych.github.io/">
      <svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="24">
        <path fill-rule="evenodd"
          d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
        </path>
      </svg>
    </a>
    <ul class="list-style-none d-flex flex-wrap col-12 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
      
      <li class="mr-3 mr-lg-0">Theme by <a href='https://github.com/MeiK2333/github-style'>github-style</a></li>
      
    </ul>
  </div>
  <div class="d-flex flex-justify-center pb-6">
    <span class="f6 text-gray-light"></span>
  </div>


</div>
</body>

<script type="application/javascript" src="https://takuto-psych.github.io/js/github-style.js"></script>



</html>